<html>

<head>
  <title>Firebase Login</title>
  <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div id="login_div" class="main-div">
    <h3>Firebase Web login Example</h3>
    <input type="email" placeholder="Email..." id="email_field" />
    <input type="password" placeholder="Password..." id="password_field" />

    <button onclick="login()">Login to Account</button>
  </div>

  <div id="user_div" class="loggedin-div">
    <h3>Welcome User</h3>
    <p id="user_para">Welcome to Firebase web login Example. You're currently logged in.</p>
    <button onclick="logout()">Logout</button>
  </div>
</body>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-firestore.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-analytics.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyClD0feYBVqMTzciMdZjYqQa7Er82zPQDs",
    authDomain: "strayanimalsapp.firebaseapp.com",
    projectId: "strayanimalsapp",
    storageBucket: "strayanimalsapp.appspot.com",
    messagingSenderId: "783963393864",
    appId: "1:783963393864:web:c5b09e1d60a6ae0530ed7d",
    measurementId: "G-QJ4C7L9L7K"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>
<script>
  var db = firebase.firestore()
  db.collection("Posts").get().then((querySnapshot) => {
    querySnapshot.forEach((doc) => {
      createPost(doc.data())
      console.log(doc.id, " => ", doc.data());
    });
  });

  function createPost(post) {
    const newDiv = document.createElement("div");

    // and give it some content
    const newContent = document.createTextNode(post.description);

    // add the text node to the newly created div
    newDiv.appendChild(newContent);
    const currentDiv = document.getElementById("login_div");
    document.body.insertBefore(newDiv, currentDiv);
  }

  firebase.auth().onAuthStateChanged(function (user) {
    if (user) {
      // User is signed in.

      document.getElementById("user_div").style.display = "block";
      document.getElementById("login_div").style.display = "none";

      var user = firebase.auth().currentUser;

      if (user != null) {


        var email_id = user.email;
        document.getElementById("user_para").innerHTML = "Welcome User : " + email_id;

      }

    } else {
      // No user is signed in.

      document.getElementById("user_div").style.display = "none";
      document.getElementById("login_div").style.display = "block";

    }
  });

  function login() {
    var userEmail = document.getElementById("email_field").value;
    var userPass = document.getElementById("password_field").value;

    firebase.auth().signInWithEmailAndPassword(userEmail, userPass).catch(function (error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;

      window.alert("Error : " + errorMessage);

      // ...
    });

  }
  function logout() {
    firebase.auth().signOut();
  }
</script>

</html>